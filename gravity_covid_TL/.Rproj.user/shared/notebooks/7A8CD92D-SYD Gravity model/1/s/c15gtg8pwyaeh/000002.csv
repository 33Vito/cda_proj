"0","```r
wtp_data <- read_csv(\"wtp_data.csv\")
key_var <- c(\"Work\", \"Shop\", \"School\", \"Public_trans\", \"Family_friend\", \"Hospital\")
## decode dummy to variable for weighting
wtp_data <- wtp_data %>% 
  mutate(Q6 = case_when(Q6r1 == 1 ~ \"emp\", 
                        Q6r2 == 1 ~ \"unemp\",
                        Q6r3 == 1 ~ \"nlab\",
                        Q6none == 1 ~ \"na\")) %>% 
  mutate(dAge = factor(as.matrix(select(wtp_data, dAger1:dAger7)) %*% 1:7, 
                       labels = paste0(\"dAge\", 2:7))) %>% 
  mutate(dAge = as.character(dAge)) %>% 
  mutate(dActivity = ifelse(is.na(dActivity), \"Other - Q1=99\", dActivity)) %>% 
  mutate(S5 = ifelse(str_detect(S5, \"not to say\"), \"na\", S5)) %>% 
  filter(S1 != \"Other\")
library(survey)
## population marginal totals for each stratum
wtp_data_svyd <- svydesign(id=~ot, data=wtp_data)
pop.gender <- data.frame(S1 = c(\"Male\", \"Female\"), 
                         Freq = c(0.493, 0.507)*nrow(wtp_data))
pop.emp <- data.frame(Q6 = c(\"emp\", \"unemp\", \"nlab\", \"na\"), 
                      Freq = c(0.579, 0.037, 0.323, 0.061)*nrow(wtp_data))
pop.age <- data.frame(dAge = paste0(\"dAge\", 2:7), 
                      Freq = c(0.123,0.206,0.185,0.167,0.140,0.179)*nrow(wtp_data))
pop.income <- data.frame(S5 = c(sort(unique(wtp_data$S5))[c(15,1,6,9:13, 2:5,7,8)], \"na\"), 
                         Freq = c(0.092,0.032,0.051,0.060,0.058,0.054,
                                  0.056,0.065,0.069,0.049,0.043,0.031,
                                  0.050,0.037,0.253)*nrow(wtp_data))
pop.mode <- data.frame(dActivity = sort(unique(wtp_data$dActivity)), 
                       Freq = c(0.107, 0.273, 0.598, 0.022)*nrow(wtp_data))
pop.larea <- data.frame(Suburb = sort(unique(wtp_data$Suburb)), 
                        Freq = c(0.0913,0.0659,0.0694,0.1026,0.0484,
                                 0.1556,0.0589,0.2007,0.0923,0.1151)*nrow(wtp_data))
# pop.warea <- data.frame(WorkSuburb)
wtp_data_w <- rake(wtp_data_svyd, 
                   list(~S1, ~Q6, ~dAge, ~S5, ~dActivity, ~Suburb), 
                   list(pop.gender,pop.emp, pop.age, pop.income, pop.mode, pop.larea))
wtp_data$wt <- weights(wtp_data_w)
```"
