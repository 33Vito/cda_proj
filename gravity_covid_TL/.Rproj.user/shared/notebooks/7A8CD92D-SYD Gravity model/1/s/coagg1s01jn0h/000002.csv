"0","```r
dd <- work %>% 
  rename(SA2 = area, value = count) %>% 
  # work_DAE %>%
  # select(Region, `2016-17`) %>%
  # rename(SA2 = Region, value = `2016-17`) %>%
  gravity(cc = ., dcut = 10, dcoef = 1, md = c(\"Driving\", \"Transit\")) %>% 
  left_join(wvr.ratio(\"Sydney - Haymarket - The Rocks\"),
            by = \"SA2\") %>%
  
  left_join(wvr.ratio(\"Parramatta - Rosehill\") %>% select(SA2, ratio) %>% rename(ratio_p = ratio),
            by = \"SA2\") %>%
  left_join(wvr.ratio(\"Badgerys Creek\") %>% select(SA2, ratio) %>% rename(ratio_b = ratio),
            by = \"SA2\") %>%
  
  filter(home > 0) %>% 
  mutate(income = rvi$avg.income[.match(SA2, rvi$area)]) %>% 
  mutate(age = rva$avg.age[.match(SA2, rva$area)]) %>% 
  mutate(female = rvg$f.share[.match(SA2, rvg$area)]) %>% 
  mutate(edu = rve$b.share[.match(SA2, rve$area)]) %>% 
  mutate(emp = rvl$emp[.match(SA2, rvl$area)]) %>% 
  mutate(pop = rvg$Total[.match(SA2, rvg$area)]) %>% 
  mutate(self = wvr.self$ratio[.match(SA2, wvr.self$SA2)]) %>%
  
  mutate(tt = data1_0830$minutes_tf[.match(SA2, data1_0830$SA2)]) %>% 
  mutate(km = data1_0830$km[.match(SA2, data1_0830$SA2)]) %>% 
  mutate(weighted.time = weighted.wvr$weighted.time[.match(SA2, weighted.wvr$SA2)]) %>% 
  mutate(`30 min` = weighted.wvr$`30 min`[.match(SA2, weighted.wvr$SA2)]) %>% 
  
  # filter(female > .4, female < .6) %>%
  filter(ratio > 0) %>% 
  filter(gravity > 0)
dd %>%
  # filter(km < 50) %>% 
  ggplot(aes(x=ratio, y=log(income), fill=emp, label=SA2, size=edu)) + 
  geom_point(alpha = .4, col=DC[7], stroke=1, shape=21) + 
  # scale_color_gradient(low = DC[3], high = DC[5], labels = percent) +
  # scale_fill_gradient(low = DC[3], high = DC[5], labels = percent) +
  scale_fill_viridis(name = \"Labour supply\", labels = percent) +
  scale_size_continuous(name = \"Education\", labels = percent) + 
  # geom_text_repel(aes(label = ifelse(SA2 %in% c(\"Sydney - Haymarket - The Rocks\", 
  #                                              \"Parramatta - Rosehill\", 
  #                                              \"North Parramatta\",
  #                                              \"North Sydney - Lavender Bay\", 
  #                                              \"Pyrmont - Ultimo\", 
  #                                              \"Potts Point - Woolloomooloo\", 
  #                                              \"Macquarie Park - Marsfield\", 
  #                                              \"Royal National Park\"), SA2, \"\"), 
  #                     col = ifelse(SA2 %in% c(\"Parramatta - Rosehill\", 
  #                                            \"North Parramatta\"), \"red\", NA)), 
  #                 size=3, 
  #                 box.padding = unit(0.3, \"lines\"),
  #                 point.padding = unit(0.3, \"lines\"),
  #                 segment.color = 'grey50') + 
  stat_smooth(method = \"lm\", col=DC[7], size=.1) +
  # ggx(limit = c(10,15)) +
  # ggy(percent, name = \"% of people working at CBD\", pbn = 8) + 
  ggy(comma, pbn = 8) +
  ggx(percent, \"Percentage_CBD\") + 
  ggl(\"right\", lt = T, pf = \"w\")
```"
