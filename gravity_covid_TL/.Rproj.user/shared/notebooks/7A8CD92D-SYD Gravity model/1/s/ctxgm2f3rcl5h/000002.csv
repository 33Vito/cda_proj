"0","```r
spdtb.avg <- spdtb %>% 
  filter(time %in% c(\"08:30\",\"17:30\")) %>%
  group_by(mode) %>% 
  summarise_all(mean, na.rm=T)
stime <- 
  wvr.ratio(\"Sydney - Haymarket - The Rocks\") %>% 
  mutate(wt = home*ratio) %>% 
  mutate(dist = data1_adj$km[.match(SA2, data1_adj$SA2)]) %>% 
  mutate(d.speed = spdtb.avg$speed[1] + ifelse(is.na(dist), 0, dist*spdtb.avg$km[1]), 
         t.speed = spdtb.avg$speed[2] + ifelse(is.na(dist), 0, dist*spdtb.avg$km[2])) %>% 
  mutate(d.time = dist/d.speed, 
         t.time = dist/t.speed)
# weighted.mean(stime$d.time, stime$home)
stime %>% 
  select(SA2, d.time, t.time, wt) %>% 
  gather(key, value, -SA2, -wt) %>% 
  ggplot(aes(x=value, col=key, weight = wt)) + 
  geom_density() + 
  ggx(function(x) x*60, name = \"Weighted average travel time to CBD (min)\") + 
  ggc(labels = c(paste0(\"Driving: avg = \", round(with(stime, weighted.mean(d.time, wt))*60), \" min\"), 
                 paste0(\"Transit: avg = \", round(with(stime, weighted.mean(t.time, wt))*60), \" min\"))) + 
  ggl(c(.85, .9)) + 
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank())
```"
